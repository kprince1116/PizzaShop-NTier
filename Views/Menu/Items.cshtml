@model IEnumerable<Pizzashop.DAL.ViewModels.Categoryviewmodel>

<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <link rel="stylesheet" href="~/css/Menu.css">
  <title>Document</title>
</head>

<body>
  <div class="d-flex">
    <div class="w-100 bg-light">
      <div>
        <div class="d-flex justify-content-between">
          <div class="ms-3">
            <p class="fs-2" style="color: rgb(0, 102, 187);">Menu</p>
          </div>
        </div>
        <div>


          <div class="d-flex border ms-3 gap-4 bg-white me-3 ">

            <ul class="nav nav-underline">
              &nbsp;&nbsp;&nbsp;
              <li class="nav-item">
                <a asp-controller="Menu" asp-action="Items" class="nav-link" aria-current="page"><svg
                    xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-list-ul"
                    viewBox="0 0 16 16">
                    <path fill-rule="evenodd"
                      d="M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5m-3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2m0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2m0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2" />
                  </svg>
                  Items
                </a>
              </li>
              &nbsp;&nbsp;&nbsp;
              <li class="nav-item">
                <a asp-controller="Menu" asp-action="Modifiers" class="nav-link"><svg xmlns="http://www.w3.org/2000/svg"
                    width="16" height="16" fill="currentColor" class="bi bi-ui-checks-grid" viewBox="0 0 16 16">
                    <path
                      d="M2 10h3a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1m9-9h3a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-3a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1m0 9a1 1 0 0 0-1 1v3a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1zm0-10a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h3a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zM2 9a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h3a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2zm7 2a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2h-3a2 2 0 0 1-2-2zM0 2a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm5.354.854a.5.5 0 1 0-.708-.708L3 3.793l-.646-.647a.5.5 0 1 0-.708.708l1 1a.5.5 0 0 0 .708 0z" />
                  </svg>
                  Modifiers</a>
              </li>
            </ul>
          </div>

          <div class="d-flex border category-box ms-3 me-3 mt-2">
            <aside class=" bg-light">
              <div class="div">
                <div class="ms-3 mb-3">
                  <div class="d-flex justify-content-between align-items-center">
                    <div class="fs-3">Category</div>
                    <img data-bs-toggle="modal" data-bs-target="#exampleModal1" class="pe-2" style="height: 25px;"
                      src="~/images/icons/plus-square.svg" alt="">

                  </div>
                </div>
                <div class=" sidebar-elements">
                  @* <a href="javascript:void(0);"
                  class="d-flex gap-2 pt-2 pb-2 ps-3 nav-link active align-items-center category-link"
                  data-category-id="@category.Id"> *@

                  @foreach (var category in Model)
                  {
                    <div class="aa">
                      <div class="d-flex justify-content-between align-items-center">
                        <a class=" d-flex gap-2 pt-2 pb-2 ps-3  nav-link active align-items-center"
                          data-category-id="@category.CategoryId" onclick="fetchItems(@category.CategoryId)">
                          <img style="height: 25px;" src="~/images/icons/dots-menu-svgrepo-com.svg">
                          <div>@category.CategoryName</div>
                        </a>
                        <div class="icons"> <a data-category-edit-id="@category.CategoryId"
                            data-category-name="@category.CategoryName" data-description="@category.Description"
                            onclick="setEditData(this)" class="edit-category" data-bs-toggle="modal"
                            data-bs-target="#editModal">
                            <img src="~/images/icons/pen-fill.svg" alt="">
                          </a>
                          <a data-category1-id="@category.CategoryId" class="delete-category" data-bs-toggle="modal"
                            data-bs-target="#deleteModal1">
                            <img src="~/images/icons/trash (1).svg" alt="">
                          </a>
                        </div>
                      </div>
                    </div>
                  }
                </div>
              </div>
            </aside>

            <div class="ps-3 container-fluid  w-100" style="background-color: white; overflow: auto;">
              <p class="fs-3">Items</p>


              <div class="d-flex align-items-center gap-3 pe-3 justify-content-end">
                <div class=" d-flex justify-content-end position-relative align-items-center ">
                  <div class="d-flex justify-content-end position-relative align-items-center">
                    <input type="text" class="search form-control" style="height: 50px;" id="userListSearch"
                      placeholder="Search" value="@ViewBag.SearchTerm">
                    <img src="~/images/icons/search.svg" alt="" style="width: 20px; aspect-ratio: 1"
                      class="bg-white position-absolute rounded-2 m-2" />
                  </div>


                </div>

                <div>
                  <img data-bs-toggle="modal" data-bs-target="#exampleModal"
                    class="border delete-icon d-flex p-lg-3 p-2" src="~/images/icons/trash (1).svg" alt="">
                </div>
                <div class="border new-item d-flex p-lg-3 p-2" data-bs-toggle="modal" data-bs-target="#exampleModal2"
                  style="background-color: rgb(0, 102, 187); color: white; text-wrap: nowrap;">

                  +New Item
                </div>
              </div>


              <div id="items-container">
                @Html.Partial("_ItemsPartial", (IEnumerable<Pizzashop.DAL.ViewModels.MenuItemsviewmodel>)ViewBag.Items)
              </div>

              <div
                class="d-flex table-footer align-items-center justify-content-end gap-lg-2 gap-md-2 gap-1 me-1 me-md-4 me-lg-4">
                <div class="d-flex align-items-center gap-1 items">
                  <span class="ps-5 font2">Items Per Page</span>
                  <select class="form-select" id="floatingSelect" aria-label="Floating label select example"
                    style="width: 60px;">
                    <option selected>5</option>
                    <option value="1">india</option>
                    <option value="2">usa</option>
                    <option value="3">uk</option>
                  </select>
                </div>
                <div class="d-flex align-items-center gap-1">
                  <span class="font2">Showing 1-5 of 13</span>
                  <div class="pt-3">
                    <nav aria-label="Page navigation example">
                      <ul class="pagination gap-2">
                        <li class="page-item">
                          <a class="page-link" href="#" aria-label="Previous">
                            <span aria-hidden="true">&laquo;</span>
                          </a>
                        </li>
                        <li class="page-item">
                          <a class="page-link" href="/Permisssion.html" aria-label="Next">
                            <span aria-hidden="true">&raquo;</span>
                          </a>
                        </li>
                      </ul>
                    </nav>
                  </div>
                </div>
              </div>

              @* <div
              class="d-flex table-footer align-items-center justify-content-end gap-lg-2 gap-md-2 gap-1 me-1 me-md-4
              me-lg-4">
              <div class="d-flex align-items-center gap-1 items">
              <span class="ps-5 font2">Items Per Page</span>
              <select class="form-select" style="width:68px ;" aria-label="Default select example"
              id="pageSizeDropdown" onchange="changePageSize()">
              <option selected>@ViewBag.pageSize</option>
              <option value="3">3</option>
              <option value="5">5</option>
              <option value="10">10</option>
              </select>
              </div>

              <div class="d-flex align-items-center gap-1">
              <span class="font2">Showing @((ViewBag.Currentpage - 1) * ViewBag.pagesize +
              1)-@Math.Min(ViewBag.Currentpage * ViewBag.pagesize, ViewBag.totalitems) of
              @ViewBag.totalitems</span>
              <div class="pt-3">
              <nav aria-label="Page navigation example">
              <ul class="pagination gap-2">
              <li class="page-item @(ViewBag.Currentpage == 1 ? "disabled" : "")">
              <a class="page-link"
              href="@Url.Action("Items", new { pagenumber = ViewBag.Currentpage - 1,pagesize=ViewBag.pagesize })"
              aria-label="Previous">
              <span aria-hidden="true">&laquo;</span>
              </a>
              </li>

              <li class="page-item active">
              <a class="page-link" href="#">@(ViewBag.Currentpage)</a>
              </li>

              <li
              class="page-item @(ViewBag.Currentpage == ViewBag.totalitems ? "disabled" : "")">
              <a class="page-link"
              href="@Url.Action("Items", new { pagenumber = ViewBag.Currentpage + 1,pagesize=ViewBag.pagesize })"
              aria-label="Next">
              <span aria-hidden="true">&raquo;</span>
              </a>
              </li>
              </ul>
              </nav>
              </div>
              </div>

              </div> *@

            </div>
          </div>
        </div>

      </div>
    </div>

    <script src="js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

</body>

</html>

@*
<script>
function changePageSize() {
var pageSize = document.getElementById("pageSizeDropdown").value;
var currentPage = @ViewBag.CurrentPage; window.location.href = '@Url.Action("Items", "Menu")' + '?pagenumber=' +
Currentpage + '&pageSize=' + pageSize;
}
</script>
*@

<script>
  $(document).ready(function () {
    const searchInput = $('#userListSearch');

    let debounceTimer;
    searchInput.on('input', function () {
      clearTimeout(debounceTimer);
      const searchTerm = $(this).val().trim();

      debounceTimer = setTimeout(() => {
        const url = new URL(window.location.href);
        if (searchTerm) {
          url.searchParams.set('searchTerm', searchTerm);
        } else {
          url.searchParams.delete('searchTerm');
        }

        $.get(url.toString(), function (data) {
          $('#items-container').html($(data).find('#items-container').html());
        });
      }, 100);
    });
  });
</script>


<script>
  function fetchItems(categoryId) {
    console.log(categoryId);
    $.ajax({
      url: '@Url.Action("ItemsByCategory", "Menu")',
      type: 'GET',
      data: { id: categoryId },
      success: function (data) {
        $('#items-container').html(data);
      }
    });
  }



</script>

<script>
  function categoryClickEvents() {
    $(document).off('click', 'category-id').on('click', '.category-id', function () {
      var categoryId = $(this).attr('category-id');
      fetchItems(categoryId);
    });
  }
  $(document).ready(function () {
    categoryClickEvents();
  }
</script>
<script>

      function setEditData(element) {
        var categoryId = element.getAttribute("data-category-edit-id");
        console.log(categoryId);
        var categoryName = element.getAttribute("data-category-name");
        var description = element.getAttribute("data-description");
        document.getElementById("CategoryId").value = categoryId;
        document.getElementById("editforname").value = categoryName;
        document.getElementById("editfordescription").value = description;
      }
</script>

<script>
      function resetForm() {
        $('form')[0].reset();
      }
</script>


<div class="modal fade" id="editModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <form method="post" asp-controller="Menu" asp-action="EditCategory" class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel1">Edit Category</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="d-flex flex-column gap-2">
          <div class="form-floating">
            <input type="hidden" id="CategoryId" name="CategoryId">
            <input type="text" class="form-control" id="editforname" name="CategoryName" placeholder="Category Name">
            <label for="editforname">Name</label>
          </div>
          <div class="form-floating">
            <input type="text" class="form-control" id="editfordescription" name="Description"
              placeholder="Description">
            <label for="editfordescription">Description</label>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-primary">Save</button>
        <button type="button" class="btn btn-secondary" onclick="resetForm()">Cancel</button>
      </div>
    </form>
  </div>
</div>

<script>
      $(document).on('click', '.delete-category', function () {
        var categoryId = $(this).data('category1-id');
        console.log(categoryId);
        $('#CategoryId1').val(categoryId);
      });
</script>

<div class="modal fade" id="deleteModal1" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Delete Confirmation</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body d-flex justify-content-center align-items-center flex-column">
        <img class="" src="images/icons/exclamation-triangle.svg" alt="">
        <h1 class="fs-5">Are You Sure you want to delete Category ?</h1>
      </div>
      <form method="post" asp-controller="Menu" asp-action="DeleteCategory"
        class="modal-footer d-flex justify-content-center">
        <input type="hidden" name="id" id="CategoryId1" />
        <button type="submit" class="btn btn-primary">Yes</button>
        <button type="button" class="btn btn-outline-primary">No</button>
      </form>
    </div>
  </div>
</div>


<div class="modal fade" id="exampleModal1" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <form method="post" asp-controller="Menu" asp-action="AddCategory" class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel1">Add Category</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="d-flex flex-column gap-2">
          <div class="form-floating">
            <input type="text" class="form-control" id="floatingInput" name="CategoryName" placeholder="Category Name">
            <label for="floatingInput">Name</label>
          </div>
          <div class="form-floating">
            <input type="text" class="form-control" id="floatingInput" name="Description" placeholder="Description">
            <label for="floatingInput">Description</label>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="submit" class="btn btn-primary">Save</button>
        <button type="button" class="btn btn-secondary" onclick="resetForm()">Cancel</button>
      </div>
    </form>
  </div>
</div>

<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Delete Confirmation</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body d-flex justify-content-center align-items-center flex-column">
        <img class="" src="images/icons/exclamation-triangle.svg" alt="">
        <h1 class="fs-5">Are You Sure you want to delete Category ?</h1>
      </div>
      <div class="modal-footer d-flex justify-content-center">
        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Yes</button>
        <button type="button" class="btn btn-outline-primary">No</button>
      </div>
    </div>
  </div>
</div>


<div class="modal fade" id="exampleModal2" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Add New Menu Item</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="conatainer-fluid">
          <div class="row">

            <div class="col-lg-8 col-12">

              <div class="row mb-3">
                <div class="col">
                  <div class="form-floating">
                    <select class="form-select" id="floatingSelect" aria-label="Floating label select example">
                      <option selected>Sandwich</option>
                      <option value="1">pizza</option>
                      <option value="2">pasta</option>
                      <option value="3">burger</option>
                    </select>
                    <label for="floatingSelect">Category</label>
                  </div>
                </div>
                <div class="col">
                  <div class="form-floating">
                    <input type="text" class="form-control" id="floatingInput" placeholder="name@example.com">
                    <label for="floatingInput">Name</label>
                  </div>
                </div>
              </div>
              <div class="row mb-3">
                <div class="col-lg-3 col-md-6 mb-md-3 mb-3 ">
                  <div class="form-floating">
                    <select class="form-select" id="floatingSelect" aria-label="Floating label select example">
                      <option selected>Select Type</option>
                      <option value="1">pizza</option>
                      <option value="2">pasta</option>
                      <option value="3">burger</option>
                    </select>
                    <label for="floatingSelect">Item Type</label>
                  </div>
                </div>
                <div class="col-lg-3 col-md-6 mb-md-3 mb-3">
                  <div class="form-floating">
                    <input type="text" class="form-control" id="floatingInput" placeholder="name@example.com">
                    <label for="floatingInput">Rate</label>
                  </div>
                </div>
                <div class="col-lg-3 col-md-6 mb-3">
                  <div class="form-floating">
                    <input type="text" class="form-control" id="floatingInput" placeholder="name@example.com">
                    <label for="floatingInput">Quantity</label>
                  </div>
                </div>
                <div class="col-lg-3 col-md-6 mb-3">
                  <div class="form-floating">
                    <select class="form-select" id="floatingSelect" aria-label="Floating label select example">
                      <option selected>Select a Unit</option>
                      <option value="1">pizza</option>
                      <option value="2">pasta</option>
                      <option value="3">burger</option>
                    </select>
                    <label for="floatingSelect">Unit</label>
                  </div>
                </div>
              </div>
              <div class="row mb-3">
                <div class="col-lg-3 col-md-6 col-6 gap-1">
                  <div class="form-check form-switch d-flex align-items-center gap-1 ms-lg-2 mb-3">
                    <input style="height: 30px; width: 60px;" class="form-check-input" type="checkbox" role="switch"
                      id="flexSwitchCheckChecked" checked>
                    <span> Available </span>
                  </div>
                </div>
                <div class="col-lg-3 col-md-6 col-6">
                  <div class="form-check form-switch d-flex align-items-center gap-1 ms-lg-2">
                    <input style="height: 30px; width: 60px;" class="form-check-input" type="checkbox" role="switch"
                      id="flexSwitchCheckChecked" checked>
                    <span class="">DefaultTax</span>
                  </div>
                </div>
                <div class="col-lg-3 col-md-6 col-12 mb-3">
                  <div class="form-floating">
                    <input type="text" class="form-control" id="floatingInput" placeholder="name@example.com">
                    <label for="floatingInput">Tax Percentage</label>
                  </div>
                </div>
                <div class="col-lg-3 col-md-6 col-12">
                  <div class="form-floating">
                    <input type="text" class="form-control" id="floatingInput" placeholder="name@example.com">
                    <label for="floatingInput">Short Code</label>
                  </div>
                </div>
              </div>
              <div class="row mb-3">
                <div class="col">
                  <textarea class="form-control" style="height: 80px;" type="text" placeholder="Description"></textarea>
                </div>
              </div>

              <div class="row">

                <div class="col-12">
                  <span>Upload Image</span>
                  <p style="height: 100px;"
                    class="form-control align-items-center d-flex flex-column justify-content-center" name="" id=""
                    placeholder="">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                      class="bi bi-cloud-arrow-up" viewBox="0 0 16 16">
                      <path fill-rule="evenodd"
                        d="M7.646 5.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 6.707V10.5a.5.5 0 0 1-1 0V6.707L6.354 7.854a.5.5 0 1 1-.708-.708z" />
                      <path
                        d="M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2 5.166 4.579C14.758 6.804 16 8.137 16 9.773 16 11.569 14.502 13 12.687 13H3.781C1.708 13 0 11.366 0 9.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383m.653.757c-.757.653-1.153 1.44-1.153 2.056v.448l-.445.049C2.064 6.805 1 7.952 1 9.318 1 10.785 2.23 12 3.781 12h8.906C13.98 12 15 10.988 15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 4.825 10.328 3 8 3a4.53 4.53 0 0 0-2.941 1.1z" />
                    </svg>
                    Drag and drops or Brows file
                    <input type="file" style="opacity: 0%;" name="" id="">
                  </p>
                </div>
              </div>
            </div>
            <div class="col-lg-4 d-lg-block d-none pt-3" style="background-color: #FDF5E6;">
              <select class="form-select  " id="autoSizingSelect">
                <option value="">Select Modifiers Groups(s) </option>
              </select>
            </div>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-primary">Save</button>
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
      </div>
    </div>
  </div>
</div>